@Echo off

Color 0A
Cd /d .\\

:: Initialize PentestBox environment

:: Search PentestBox Root Directory

@Set PentestBox_ROOT=%Cd%
@Set Python_Root=%PentestBox_ROOT%\base\python\
@Set PentestBox_Execute_Scripts=%PentestBox_ROOT%\bin\scripts\
@Set PATH=%PATH%;%PentestBox_ROOT%\;%Python_Root%;%PentestBox_Execute_Scripts%;

:: %~dp0 = Current X:\Directory\
:: %Cd% = Current X:\Directory

:: Change the prompt style
@Prompt $E[1;32;40m$P$S{git}$S$_$E[1;30;40m{lamb}$S$E[0m

:: Pick right version of clink
@If "%PROCESSOR_ARCHITECTURE%"=="x86" (
    Set Architecture=86
) Else (
    Set Architecture=64
)

:: Run clink
@"%PentestBox_ROOT%\base\clink\clink_x%Architecture%.exe" inject --quiet --profile "%PentestBox_ROOT%\config"

:: I do not even know, copypasted from their .bat
@Set PLINK_PROTOCOL=ssh
@If not defined TERM set TERM=cygwin

:: Linking Path
@Set git_install_root=%PentestBox_ROOT%\base\PortableGit
@Set PATH=%PentestBox_ROOT%\bin;%Git_Install_Root%\bin;%Git_Install_Root%\mingw32\bin;%Git_Install_Root%\usr\bin;%Git_Install_Root%\cmd;%Git_Install_Root%\share\vim\vim74;%PentestBox_ROOT%\base\curl\bin;%PentestBox_ROOT%\base\python;%PentestBox_ROOT%\base\ruby\bin;%PentestBox_ROOT%\base\ruby_devkit\bin;%PentestBox_ROOT%\base\ruby_devkit\mingw\bin;%PentestBox_ROOT%\base\strawberry-perl\perl\bin;%PentestBox_ROOT%\base\strawberry-perl\c\bin;%PentestBox_ROOT%\base\strawberry-perl\;%PentestBox_ROOT%\bin\nmap;%PentestBox_ROOT%\base\jdk1.8.0_74\bin;%PentestBox_ROOT%\base\jdk1.8.0_74\jre\bin;%PentestBox_ROOT%\base\jdk1.8.0_74\jre\lib;%PentestBox_ROOT%\bin\aircrack-ng-1.2-rc4-win\bin\32bit;%PentestBox_ROOT%\bin\password_attacks\rainbowcrack;%PentestBox_ROOT%\bin\androidsecurity\dex2jar;%PentestBox_ROOT%\bin\androidsecurity\sdk\platform-tools;%PentestBox_ROOT%\base\python\Scripts;%PentestBox_ROOT%\bin\7za;%PentestBox_ROOT%\bin\wget;%SystemRoot%\system32
@Set PYTHONPATH=%PentestBox_ROOT%\base\python\Lib\site-packages
@Set CURL_CA_BUNDLE=%PentestBox_ROOT%\base\curl\bin\ca-bundle.crt
@If not defined SSL_CERT_FILE Set SSL_CERT_FILE=%PentestBox_ROOT%\base\curl\bin\cacert.pem

:: Add aliases
@doskey /macrofile="%PentestBox_ROOT%\config\aliases"
:: Custom aliases
@If exist "%PentestBox_ROOT%\bin\customtools\customaliases" (
	@doskey /macrofile="%PentestBox_ROOT%\bin\customtools\customaliases"
)



:MainMenu

Cls

Echo ----------------------------------------------------------------------------------------------------
Echo=
Echo Welcome to PentestBox-Script-System quick access manager, Power by windows batch script
Echo=
Echo ----------------------------------------------------------------------------------------------------
Echo=
Echo Input 1 Show all help in PentestBox-Script-System or You can operating more PentestBox command
Echo Input 2 Execute update command in PentestBox-Script-System and Download all component data
Echo Input 3 Execute PentestBox (Component)Tools Manager Script-System
Echo=
Echo Input [Kill]: Exit Batch Script
Echo=
Echo ----------------------------------------------------------------------------------------------------
Echo=
Echo Maker by Author Twlilght-Dream-Of-Magic(Twlilght_Yujiang)
Echo=
Echo ----------------------------------------------------------------------------------------------------
Echo=



::#####Logical branch start#####::
Set /p User_Input="Console:\PentestBox\ScriptSystem\UserInput> "

If %User_Input% == 1 (

Goto User_Output

) Else If %User_Input% == 2 (

Goto User_Output2

) Else If %User_Input% == 3 (

Goto User_Output3

) Else If %User_Input% == Kill (

Goto Cycle-Jump-Out

) Else (

Echo User Input String Error!

Pause

Cls

Goto MainMenu

Cls
)
::#####Logical branch end#####::


:User_Output

::PentestBox-Script-System-Help

Cls

Echo=
Echo "*********** Welcome to PentestBox tools update utility. ************"
Echo  +-----------------------------+------------------------------------+
Echo "|           Commands          |             Explanation            |"
Echo  +-----------------------------+------------------------------------+
Echo "| update android              | Updates Android Security Tools     |"
Echo "| update exploitation         | Updates Exploitation Tools         |"
Echo "| update forensics            | Updates Forensics Tools            |"
Echo "| update informationgathering | Updates InformationGathering Tools |"
Echo "| update passwordattacks      | Updates Password Attacks Tools     |"
Echo "| update reverseengineering   | Updates Reverse Engineering Tools  |"
Echo "| update sniffing             | Updates Sniffing Tools             |"
Echo "| update stresstesting        | Updates Stress Testing Tools       |"
Echo "| update webapplication       | Updates WebApplication Tools       |"
Echo "| update config               | Updates PentestBox Config Files    |"
Echo  +-----------------------------+------------------------------------+
Echo=
Echo ####################################################################
Echo=
Echo ----------------------------------------------------------------------------------------------------------------------------------
Echo Input [RunOtherCommandOperations] or ROCO, Execute other update command in PentestBox-Script-System.
Echo Input [Back], Return main menu.
Echo ----------------------------------------------------------------------------------------------------------------------------------
Echo=



::#####Logical branch start#####::
Set /p Command_Choice="Your Choice: "

If %Command_Choice% == RunOtherCommandOperations (

Goto RunOtherCommandOperations

) Else If %Command_Choice% == ROCO (

Goto RunOtherCommandOperations

) Else If %Command_Choice% == Back (

Cls

Goto MainMenu

) Else (

Echo User Input String Error!

Pause

Cls

Goto User_Output

Cls
)
::#####Logical branch end#####::



:RunOtherCommandOperations

Echo=

Set /p OtherCommandOperations="No need to input string [update], Your input command: "

Cls

cmd.exe /k %Python_Root%\python.exe %PentestBox_Execute_Scripts%\update.py %OtherCommandOperations%

Pause

Goto MainMenu



:User_Output2

::PentestBox-Script-System

Cls

Echo  +-----------------------------+------------------------------------+
Echo "|         Continue         execute           command       ?       |"
Echo  +-----------------------------+------------------------------------+
Echo "|        update all           | Updates Everything in PentestBox   |"
Echo  +-----------------------------+------------------------------------+
Echo= 

Echo "Coming soon execute command, All PentestBox-Tools will be updated and Download all PentestBox-Component data."
Echo= 



::#####Logical branch start#####::
Set /p Need_PentestBox_All_Update="Do you need to continue? [Yes/No](Y/N) "

If %Need_PentestBox_All_Update% == YES (

Cls
Goto Need-To-Be-Update

) Else If %Need_PentestBox_All_Update% == Yes (

Cls
Goto Need-To-Be-Update

) Else If %Need_PentestBox_All_Update% == yes (

Cls
Goto Need-To-Be-Update

) Else If %Need_PentestBox_All_Update% == Y (

Cls
Goto Need-To-Be-Update

) Else If %Need_PentestBox_All_Update% == y (

Cls
Goto Need-To-Be-Update

::----------::

) Else If %Need_PentestBox_All_Update% == NO (

Cls
Goto Not-Need-To-Be-Update

) Else If %Need_PentestBox_All_Update% == No (

Cls

Goto Not-Need-To-Be-Update

) Else If %Need_PentestBox_All_Update% == no (

Cls
Goto Not-Need-To-Be-Update

) Else If %Need_PentestBox_All_Update% == N (

Cls

Goto Not-Need-To-Be-Update

) Else If %Need_PentestBox_All_Update% == n (

Cls
Goto Not-Need-To-Be-Update

) Else (

Echo User Input String Error!

Pause
Cls
Goto User_Output2

Cls
)
::#####Logical branch end#####::



:Need-To-Be-Update

Cls

Echo You have confirmed the choice, PentestBox needs to be updated.

Pause

Cls

Echo Plaese wait......

cmd.exe /k %Python_Root%\python.exe %PentestBox_Execute_Scripts%\update.py all

Pause

Goto MainMenu



:Not-Need-To-Be-Update

Cls

Echo You have canceled the update.

Pause

Goto MainMenu



:User_Output3

::PentestBox-Tools-Manager

Cls

cmd.exe /k %Python_Root%\python.exe %PentestBox_Execute_Scripts%\toolsmanager.py

Pause

Goto MainMenu



:: Stop PentestBox-Script-System quick access manager

:Cycle-Jump-Out

Cls

Echo "Leaving......"

Pause

Exit